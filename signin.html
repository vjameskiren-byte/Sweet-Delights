<!DOCTYPE html>
<html>
<head>
    <title>Sign In</title>
    <link rel="stylesheet" href="css/signin.css">
</head>
<body>
    <div class="center-wrapper">
        <div class="logo-container">
            <img src="images/logo.png" alt="Sweet Delights' Logo">
        </div>
    <form id="sign-in-form">
        <h2>Sign In</h2>
        <input type="text" id="username" required placeholder="Username"><br>
        <input type="email" id="email" required placeholder="Email"><br>
        <input type="password" id="password" required placeholder="Password"><br>
        <input type="file" id="picture" accept="image/*" required><br>
        <button type="submit">Sign In</button>
        <a href="login.html">Already have an account?</a>
    </form>

    <script>
        document.getElementById("sign-in-form").addEventListener("submit", function(event) {
            event.preventDefault();

            const username = document.getElementById("username").value;
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const pictureFile = document.getElementById("picture").files[0];

            // Create a FileReader to convert the image to Base64
            const reader = new FileReader();
            reader.onloadend = function() {
                const newUser = { username, email, password, picture: reader.result };

                // Get existing accounts from localStorage or create an empty array if none exist
                let accounts = JSON.parse(localStorage.getItem("accounts")) || [];

                // Add the new user to the array of accounts
                accounts.push(newUser);

                // Store the updated accounts array back into localStorage
                localStorage.setItem("accounts", JSON.stringify(accounts));

                // Log in the new user
                //localStorage.setItem("loggedIn", true);
                localStorage.setItem("user", JSON.stringify(newUser));

                alert("Sign in successful!");
                window.location.href = "login.html";  // Redirect to login page
            };

            // Read the image file as a Data URL (Base64)
            if (pictureFile) {
                reader.readAsDataURL(pictureFile);
            } else {
                alert("Please upload a profile picture.");
            }
        });
    </script>
</body>
</html>